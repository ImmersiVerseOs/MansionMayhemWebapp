<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cast Leaderboard | Mansion Mayhem</title>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700;900&family=Montserrat:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/navigation.css">
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    :root{--bg:#0a0a0a;--bg-card:#111;--bg-elevated:#1a1a1a;--border:#2a2a2a;--text:#fff;--text-dim:#888;--text-muted:#555;--gold:#d4af37;--gold-light:#f4e4bc;--rose:#e91e63;--purple:#9c27b0;--success:#4caf50;--warning:#ff9800;--silver:#c0c0c0;--bronze:#cd7f32}
    body{font-family:'Montserrat',sans-serif;background:var(--bg);color:var(--text);min-height:100vh;line-height:1.6}
    .page-bg{position:fixed;inset:0;background:radial-gradient(ellipse at top left,rgba(212,175,55,.1) 0%,transparent 50%),radial-gradient(ellipse at bottom right,rgba(233,30,99,.08) 0%,transparent 50%),var(--bg);z-index:-1}
    
    /* Header */
    .header{padding:16px 24px;border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center;background:rgba(10,10,10,.95);backdrop-filter:blur(10px);position:sticky;top:0;z-index:100}
    .logo{font-family:'Playfair Display',serif;font-size:20px;font-weight:900;background:linear-gradient(135deg,var(--gold),var(--gold-light));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
    .logo span{display:block;font-family:'Montserrat',sans-serif;font-size:10px;font-weight:600;letter-spacing:3px;background:linear-gradient(135deg,var(--rose),var(--purple));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
    .header-episode{background:var(--bg-elevated);border:1px solid var(--border);padding:8px 16px;border-radius:20px;font-size:12px;font-weight:600}
    
    /* Main */
    .main{max-width:1100px;margin:0 auto;padding:32px 20px}
    
    /* Hero */
    .hero{text-align:center;margin-bottom:48px}
    .hero-title{font-family:'Playfair Display',serif;font-size:48px;font-weight:900;margin-bottom:8px;background:linear-gradient(135deg,var(--gold),var(--gold-light));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
    .hero-subtitle{color:var(--text-dim);font-size:16px}
    
    /* Stats Overview */
    .stats-overview{display:grid;grid-template-columns:repeat(4,1fr);gap:16px;margin-bottom:48px}
    .stat-card{background:var(--bg-card);border:1px solid var(--border);border-radius:16px;padding:24px;text-align:center}
    .stat-value{font-family:'Playfair Display',serif;font-size:36px;font-weight:700;margin-bottom:4px}
    .stat-value.gold{color:var(--gold)}
    .stat-value.rose{color:var(--rose)}
    .stat-value.purple{color:var(--purple)}
    .stat-value.success{color:var(--success)}
    .stat-label{font-size:11px;font-weight:600;letter-spacing:1px;text-transform:uppercase;color:var(--text-dim)}
    
    /* Top 3 Podium */
    .podium{display:flex;justify-content:center;align-items:flex-end;gap:16px;margin-bottom:48px;padding:0 20px}
    .podium-card{background:var(--bg-card);border:1px solid var(--border);border-radius:20px;padding:24px;text-align:center;transition:all .3s ease;position:relative}
    .podium-card:hover{transform:translateY(-8px)}
    .podium-card.first{order:2;border-color:var(--gold);padding-bottom:48px}
    .podium-card.second{order:1;padding-bottom:32px}
    .podium-card.third{order:3;padding-bottom:24px}
    .podium-rank{position:absolute;top:-16px;left:50%;transform:translateX(-50%);width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-family:'Playfair Display',serif;font-size:18px;font-weight:700}
    .podium-card.first .podium-rank{background:linear-gradient(135deg,var(--gold),var(--gold-light));color:var(--bg);width:48px;height:48px;font-size:22px}
    .podium-card.second .podium-rank{background:linear-gradient(135deg,var(--silver),#e8e8e8);color:var(--bg)}
    .podium-card.third .podium-rank{background:linear-gradient(135deg,var(--bronze),#e6a87c);color:var(--bg)}
    .podium-avatar{width:100px;height:100px;border-radius:50%;background:linear-gradient(135deg,var(--rose),var(--purple));margin:16px auto;display:flex;align-items:center;justify-content:center;font-size:32px;font-weight:700}
    .podium-card.first .podium-avatar{width:120px;height:120px;font-size:40px;border:4px solid var(--gold)}
    .podium-name{font-size:20px;font-weight:700;margin-bottom:4px}
    .podium-card.first .podium-name{font-size:24px}
    .podium-archetype{font-size:11px;color:var(--text-dim);letter-spacing:1px;text-transform:uppercase;margin-bottom:16px}
    .podium-stat{display:flex;justify-content:center;gap:24px}
    .podium-stat-item{text-align:center}
    .podium-stat-value{font-size:18px;font-weight:700;color:var(--gold)}
    .podium-stat-label{font-size:9px;color:var(--text-muted);letter-spacing:1px;text-transform:uppercase}
    
    /* Filter Tabs */
    .filter-tabs{display:flex;gap:8px;margin-bottom:24px;flex-wrap:wrap}
    .filter-tab{background:var(--bg-elevated);border:1px solid var(--border);padding:10px 20px;border-radius:20px;font-size:12px;font-weight:600;cursor:pointer;transition:all .2s}
    .filter-tab:hover{border-color:var(--gold)}
    .filter-tab.active{background:linear-gradient(135deg,var(--gold),var(--gold-light));border-color:transparent;color:var(--bg)}
    
    /* Leaderboard Table */
    .leaderboard{background:var(--bg-card);border:1px solid var(--border);border-radius:20px;overflow:hidden}
    .leaderboard-header{display:grid;grid-template-columns:60px 1fr 100px 100px 100px 100px 80px;padding:16px 24px;background:var(--bg-elevated);border-bottom:1px solid var(--border);font-size:10px;font-weight:700;letter-spacing:1px;text-transform:uppercase;color:var(--text-muted)}
    .leaderboard-row{display:grid;grid-template-columns:60px 1fr 100px 100px 100px 100px 80px;padding:16px 24px;border-bottom:1px solid var(--border);align-items:center;transition:background .2s}
    .leaderboard-row:hover{background:var(--bg-elevated)}
    .leaderboard-row:last-child{border-bottom:none}
    
    .row-rank{font-family:'Playfair Display',serif;font-size:20px;font-weight:700;color:var(--text-dim)}
    .row-rank.top3{color:var(--gold)}
    
    .row-cast{display:flex;align-items:center;gap:12px}
    .row-avatar{width:44px;height:44px;border-radius:50%;background:linear-gradient(135deg,var(--rose),var(--purple));display:flex;align-items:center;justify-content:center;font-size:14px;font-weight:700}
    .row-info{flex:1}
    .row-name{font-weight:600;font-size:14px;margin-bottom:2px}
    .row-archetype{font-size:10px;color:var(--text-dim);letter-spacing:1px;text-transform:uppercase}
    
    .row-stat{text-align:center}
    .row-stat-value{font-size:16px;font-weight:700}
    .row-stat-value.high{color:var(--success)}
    .row-stat-value.medium{color:var(--warning)}
    .row-stat-value.low{color:var(--rose)}
    .row-stat-bar{height:4px;background:var(--bg);border-radius:2px;margin-top:4px;overflow:hidden}
    .row-stat-fill{height:100%;border-radius:2px}
    .row-stat-fill.green{background:var(--success)}
    .row-stat-fill.gold{background:var(--gold)}
    .row-stat-fill.rose{background:var(--rose)}
    
    .row-trend{text-align:center;font-size:14px}
    .trend-up{color:var(--success)}
    .trend-down{color:var(--rose)}
    .trend-same{color:var(--text-muted)}
    
    /* Status Badges */
    .status-badge{display:inline-block;padding:4px 10px;border-radius:10px;font-size:10px;font-weight:700;letter-spacing:1px}
    .status-badge.active{background:rgba(76,175,80,.2);color:var(--success)}
    .status-badge.hotseat{background:rgba(233,30,99,.2);color:var(--rose)}
    .status-badge.immune{background:rgba(212,175,55,.2);color:var(--gold)}
    .status-badge.eliminated{background:rgba(85,85,85,.3);color:var(--text-muted)}
    
    /* Archetype Filter */
    .archetype-filters{display:flex;gap:8px;margin-bottom:24px;flex-wrap:wrap}
    .archetype-chip{background:var(--bg-elevated);border:1px solid var(--border);padding:6px 14px;border-radius:16px;font-size:11px;cursor:pointer;transition:all .2s;display:flex;align-items:center;gap:6px}
    .archetype-chip:hover{border-color:var(--gold)}
    .archetype-chip.active{border-color:var(--rose);background:rgba(233,30,99,.1)}
    
    /* Mobile */
    @media(max-width:900px){
      .stats-overview{grid-template-columns:repeat(2,1fr)}
      .leaderboard-header,.leaderboard-row{grid-template-columns:50px 1fr 80px 80px}
      .leaderboard-header>*:nth-child(n+5),.leaderboard-row>*:nth-child(n+5){display:none}
      .podium{flex-direction:column;align-items:center}
      .podium-card{order:unset!important;width:100%;max-width:280px}
    }
    @media(max-width:600px){
      .hero-title{font-size:32px}
      .podium-avatar{width:80px!important;height:80px!important;font-size:24px!important}
    }
  </style>
</head>
<body>
  <!-- MANSION MAYHEM - Persistent Navigation Bar -->
  <!-- Navigation (loaded from include) -->
  <div id="globalNavPlaceholder"></div>
  <script>
    fetch('/includes/global-nav.html')
      .then(response => response.text())
      .then(data => {
        document.getElementById('globalNavPlaceholder').innerHTML = data;
      });
  </script>
  <!-- Navigation loaded - displays role-based links, notifications, and user menu -->

  <div class="page-bg"></div>

  <header class="header">
    <div class="logo">MANSION MAYHEM<span>Leaderboard</span></div>
    <div class="header-episode">üì∫ Episode 4</div>
  </header>
  
  <main class="main">
    <!-- Hero -->
    <div class="hero">
      <h1 class="hero-title">Cast Leaderboard</h1>
      <p class="hero-subtitle">Real-time stats ‚Ä¢ Fan votes ‚Ä¢ Drama rankings</p>
    </div>
    
    <!-- Stats Overview -->
    <!-- Data loaded via JavaScript from Supabase -->
    <div class="stats-overview">
      <div class="stat-card">
        <div class="stat-value gold">-</div>
        <div class="stat-label">Cast Members</div>
      </div>
      <div class="stat-card">
        <div class="stat-value rose">-</div>
        <div class="stat-label">Voice Notes</div>
      </div>
      <div class="stat-card">
        <div class="stat-value purple">-</div>
        <div class="stat-label">Total Votes</div>
      </div>
      <div class="stat-card">
        <div class="stat-value success">-%</div>
        <div class="stat-label">Avg Response</div>
      </div>
    </div>
    
    <!-- Top 3 Podium -->
    <!-- Data loaded via JavaScript from Supabase -->
    <div class="podium">
      <div class="podium-card second">
        <div class="podium-rank">2</div>
        <div class="podium-avatar">--</div>
        <div class="podium-name">Loading...</div>
        <div class="podium-archetype">Cast Member</div>
        <div class="podium-stat">
          <div class="podium-stat-item"><div class="podium-stat-value">-</div><div class="podium-stat-label">Votes</div></div>
          <div class="podium-stat-item"><div class="podium-stat-value">-</div><div class="podium-stat-label">Features</div></div>
        </div>
      </div>

      <div class="podium-card first">
        <div class="podium-rank">1</div>
        <div class="podium-avatar">--</div>
        <div class="podium-name">Loading...</div>
        <div class="podium-archetype">Cast Member</div>
        <div class="podium-stat">
          <div class="podium-stat-item"><div class="podium-stat-value">-</div><div class="podium-stat-label">Votes</div></div>
          <div class="podium-stat-item"><div class="podium-stat-value">-</div><div class="podium-stat-label">Features</div></div>
        </div>
      </div>

      <div class="podium-card third">
        <div class="podium-rank">3</div>
        <div class="podium-avatar">--</div>
        <div class="podium-name">Loading...</div>
        <div class="podium-archetype">Cast Member</div>
        <div class="podium-stat">
          <div class="podium-stat-item"><div class="podium-stat-value">-</div><div class="podium-stat-label">Votes</div></div>
          <div class="podium-stat-item"><div class="podium-stat-value">-</div><div class="podium-stat-label">Features</div></div>
        </div>
      </div>
    </div>
    
    <!-- Filters -->
    <div class="filter-tabs">
      <div class="filter-tab active">üèÜ Fan Votes</div>
      <div class="filter-tab">üì∫ Screen Time</div>
      <div class="filter-tab">üé§ Voice Notes</div>
      <div class="filter-tab">‚ö° Response Rate</div>
      <div class="filter-tab">üî• Drama Score</div>
    </div>
    
    <!-- Archetype Filters -->
    <div class="archetype-filters">
      <div class="archetype-chip active">All</div>
      <div class="archetype-chip">üëë Queens</div>
      <div class="archetype-chip">üòà Villains</div>
      <div class="archetype-chip">üé≤ Wildcards</div>
      <div class="archetype-chip">ü§ù Loyalists</div>
      <div class="archetype-chip">üíÖ Socialites</div>
    </div>
    
    <!-- Leaderboard Table -->
    <div class="leaderboard">
      <div class="leaderboard-header">
        <div>Rank</div>
        <div>Cast Member</div>
        <div>Fan Votes</div>
        <div>Response</div>
        <div>Voice Notes</div>
        <div>Status</div>
        <div>Trend</div>
      </div>
      <div id="leaderboardRows">
        <!-- Leaderboard rows loaded from database via renderLeaderboard() -->
      </div>
    </div>
  </main>
  
  <!-- Supabase Integration -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
    // Initialize Supabase Client (global scope for navigation.js)
    var supabase = window.supabase.createClient(
      'https://fpxbhqibimekjhlumnmc.supabase.co',
      'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1sbHF6ZWF4cXVzb3J5dGVheHpnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA0ODA1NzAsImV4cCI6MjA4NjA1NjU3MH0.s9CAe91gUG8uZ7Nrjd1pIX9YYvpNKa2lOrt6HDUarec'
    );

    let allCastMembers = [];
    let currentSortBy = 'fan_votes';
    let selectedArchetype = 'all';

    // ========================================
    // LOAD CAST MEMBERS WITH STATS
    // ========================================
    async function loadLeaderboard() {
      const { data, error } = await supabase
        .from('cast_members')
        .select(`
          *,
          scenario_responses (
            id,
            voice_note_url,
            featured_in_episode,
            status
          )
        `)
        .order('fan_votes', { ascending: false });

      if (error) {
        console.error('Error loading leaderboard:', error);
        return;
      }

      // Calculate additional stats
      allCastMembers = data.map((member, index) => {
        const responses = member.scenario_responses || [];
        const voiceNotes = responses.filter(r => r.voice_note_url).length;
        const featuredCount = responses.filter(r => r.featured_in_episode).length;

        return {
          ...member,
          rank: index + 1,
          voice_notes_count: voiceNotes,
          featured_count: featuredCount,
          response_rate: member.response_rate || calculateResponseRate(responses)
        };
      });

      renderLeaderboard(allCastMembers);
      renderPodium(allCastMembers.slice(0, 3));
      updateOverallStats();
    }

    function calculateResponseRate(responses) {
      const submitted = responses.filter(r => r.status === 'submitted').length;
      const total = responses.length;
      return total > 0 ? Math.round((submitted / total) * 100) : 0;
    }

    // ========================================
    // RENDER PODIUM (TOP 3)
    // ========================================
    function renderPodium(top3) {
      if (top3.length < 3) return;

      const podiumCards = document.querySelectorAll('.podium-card');

      // First place (middle)
      renderPodiumCard(podiumCards[1], top3[0], 1);

      // Second place (left)
      renderPodiumCard(podiumCards[0], top3[1], 2);

      // Third place (right)
      renderPodiumCard(podiumCards[2], top3[2], 3);
    }

    function renderPodiumCard(card, member, position) {
      const initials = getInitials(member.name);
      const firstName = member.name.split(' ')[0];
      const archetype = member.archetype || 'Cast Member';

      card.querySelector('.podium-avatar').textContent = initials;
      card.querySelector('.podium-name').textContent = firstName;
      card.querySelector('.podium-archetype').textContent = archetype;

      const stats = card.querySelectorAll('.podium-stat-value');
      stats[0].textContent = formatNumber(member.fan_votes || 0);
      stats[1].textContent = member.featured_count || 0;
    }

    // ========================================
    // RENDER LEADERBOARD TABLE
    // ========================================
    function renderLeaderboard(members) {
      const container = document.getElementById('leaderboardRows');
      if (!container) return;

      if (members.length === 0) {
        container.innerHTML = '<div style="padding: 40px; text-align: center; color: #888;">No cast members found</div>';
        return;
      }

      const leaderboardHTML = members.map((member, index) => {
        const rank = index + 1;
        const isTop3 = rank <= 3;
        const displayName = member.display_name || member.full_name || member.name || 'Unknown';
        const initials = getInitials(displayName);
        const responseRateClass = getResponseRateClass(member.response_rate);

        // Get status
        const status = getStatus(member);

        // Get trend (mock for now - you can add a trend field to database)
        const trend = getTrend(index);

        return `
          <div class="leaderboard-row">
            <div class="row-rank ${isTop3 ? 'top3' : ''}">${rank}</div>
            <div class="row-cast">
              <div class="row-avatar">${initials}</div>
              <div class="row-info">
                <div class="row-name">${displayName}</div>
                <div class="row-archetype">${getArchetypeIcon(member.archetype)} ${member.archetype || 'Cast Member'}</div>
              </div>
            </div>
            <div class="row-stat">
              <div class="row-stat-value">${formatNumber(member.fan_votes || 0)}</div>
              <div class="row-stat-bar"><div class="row-stat-fill gold" style="width:${Math.min(100, (member.fan_votes || 0) / 500)}%"></div></div>
            </div>
            <div class="row-stat">
              <div class="row-stat-value ${responseRateClass}">${member.response_rate}%</div>
              <div class="row-stat-bar"><div class="row-stat-fill ${responseRateClass === 'high' ? 'green' : 'rose'}" style="width:${member.response_rate}%"></div></div>
            </div>
            <div class="row-stat">
              <div class="row-stat-value">${member.voice_notes_count || 0}</div>
            </div>
            <div>
              <span class="status-badge ${status.class}">${status.text}</span>
            </div>
            <div class="row-trend ${trend.class}">${trend.text}</div>
          </div>
        `;
      }).join('');

      container.innerHTML = leaderboardHTML;
    }

    // ========================================
    // SORT & FILTER
    // ========================================
    function sortLeaderboard(sortBy) {
      currentSortBy = sortBy;

      let sorted = [...allCastMembers];

      switch (sortBy) {
        case 'fan_votes':
          sorted.sort((a, b) => (b.fan_votes || 0) - (a.fan_votes || 0));
          break;
        case 'screen_time':
          sorted.sort((a, b) => (b.screen_time_score || 0) - (a.screen_time_score || 0));
          break;
        case 'voice_notes':
          sorted.sort((a, b) => (b.voice_notes_count || 0) - (a.voice_notes_count || 0));
          break;
        case 'response_rate':
          sorted.sort((a, b) => (b.response_rate || 0) - (a.response_rate || 0));
          break;
      }

      // Re-assign ranks
      sorted = sorted.map((member, index) => ({ ...member, rank: index + 1 }));

      renderLeaderboard(sorted);
    }

    function filterByArchetype(archetype) {
      selectedArchetype = archetype;

      let filtered = allCastMembers;

      if (archetype !== 'all') {
        filtered = filtered.filter(member => {
          const memberArchetype = (member.archetype || '').toLowerCase();
          return memberArchetype.includes(archetype.toLowerCase());
        });
      }

      renderLeaderboard(filtered);
    }

    // ========================================
    // UPDATE OVERALL STATS
    // ========================================
    function updateOverallStats() {
      const stats = document.querySelectorAll('.stat-value');
      if (stats.length >= 4) {
        stats[0].textContent = allCastMembers.length;

        const totalVoiceNotes = allCastMembers.reduce((sum, m) => sum + (m.voice_notes_count || 0), 0);
        stats[1].textContent = totalVoiceNotes;

        const totalVotes = allCastMembers.reduce((sum, m) => sum + (m.fan_votes || 0), 0);
        stats[2].textContent = formatNumber(totalVotes);

        const avgResponseRate = Math.round(
          allCastMembers.reduce((sum, m) => sum + (m.response_rate || 0), 0) / allCastMembers.length
        );
        stats[3].textContent = avgResponseRate + '%';
      }
    }

    // ========================================
    // UTILITY FUNCTIONS
    // ========================================
    function getInitials(name) {
      return name.split(' ').map(n => n[0]).join('').toUpperCase().slice(0, 2);
    }

    function formatNumber(num) {
      if (num >= 1000) {
        return (num / 1000).toFixed(1) + 'K';
      }
      return num.toString();
    }

    function getResponseRateClass(rate) {
      if (rate >= 85) return 'high';
      if (rate >= 65) return 'medium';
      return 'low';
    }

    function getStatus(member) {
      // You can add actual status fields to your database
      if (member.fan_votes > 40000) {
        return { class: 'immune', text: 'üëë Leader' };
      } else if (member.response_rate < 70) {
        return { class: 'hotseat', text: 'üî• Hot Seat' };
      }
      return { class: 'active', text: 'Active' };
    }

    function getTrend(index) {
      // Mock trend - you can add historical data to track actual trends
      const trends = ['‚Üë 2', '‚Üë 1', '‚Äî', '‚Üë 3', '‚Üì 2', '‚Äî', '‚Üë 1'];
      const trend = trends[index % trends.length];

      if (trend.startsWith('‚Üë')) {
        return { class: 'trend-up', text: trend };
      } else if (trend.startsWith('‚Üì')) {
        return { class: 'trend-down', text: trend };
      }
      return { class: 'trend-same', text: trend };
    }

    function getArchetypeIcon(archetype) {
      const icons = {
        'The Queen': 'üëë',
        'The Villain': 'üòà',
        'The Socialite': 'üíÖ',
        'The Icon': '‚≠ê',
        'The Wildcard': 'üé≤',
        'The Loyalist': 'ü§ù',
        'The Observer': 'üëÅÔ∏è',
        'The Competitor': 'üèÜ'
      };
      return icons[archetype] || '‚ú®';
    }

    // ========================================
    // EVENT LISTENERS
    // ========================================
    // Tab switching
    document.querySelectorAll('.filter-tab').forEach(tab => {
      tab.addEventListener('click', function() {
        document.querySelectorAll('.filter-tab').forEach(t => t.classList.remove('active'));
        this.classList.add('active');

        const text = this.textContent.toLowerCase();
        if (text.includes('votes')) sortLeaderboard('fan_votes');
        else if (text.includes('screen')) sortLeaderboard('screen_time');
        else if (text.includes('voice')) sortLeaderboard('voice_notes');
        else if (text.includes('response')) sortLeaderboard('response_rate');
      });
    });

    // Archetype filter
    document.querySelectorAll('.archetype-chip').forEach(chip => {
      chip.addEventListener('click', function() {
        document.querySelectorAll('.archetype-chip').forEach(c => c.classList.remove('active'));
        this.classList.add('active');

        const text = this.textContent.toLowerCase();
        if (text.includes('all')) filterByArchetype('all');
        else if (text.includes('queens')) filterByArchetype('queen');
        else if (text.includes('villains')) filterByArchetype('villain');
        else if (text.includes('wildcards')) filterByArchetype('wildcard');
        else if (text.includes('loyalists')) filterByArchetype('loyalist');
        else if (text.includes('socialites')) filterByArchetype('socialite');
      });
    });

    // ========================================
    // INITIALIZE
    // ========================================
    async function init() {
      await loadLeaderboard();

      // Auto-refresh every 30 seconds
      setInterval(loadLeaderboard, 30000);
    }

    init();
  </script>
  <script type="module" src="js/invite-gate.js"></script>
  <script src="/js/navigation.js"></script>
</body>
</html>
