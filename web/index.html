<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mansion Mayhem</title>
  <link rel="stylesheet" href="/css/candy.css">
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <style>
    .landing{display:grid;grid-template-columns:1fr 1fr;min-height:100vh}
    .landing-left{display:flex;flex-direction:column;justify-content:center;padding:4rem 5rem;position:relative;z-index:1}
    .landing-right{display:flex;align-items:center;justify-content:center;padding:3rem;position:relative;z-index:1;border-left:1px solid var(--border)}
    .ll-badge{margin-bottom:2rem}
    .ll-title{margin-bottom:1rem}
    .ll-desc{font-size:1.1rem;color:var(--text2);max-width:420px;line-height:1.65;margin-bottom:2.5rem}
    .ll-feats{display:flex;gap:0.6rem;flex-wrap:wrap;margin-bottom:3rem}
    .ll-feat{display:flex;align-items:center;gap:0.35rem;padding:0.5rem 0.9rem;border-radius:var(--r-pill);background:var(--card);border:1px solid var(--border);font-size:0.8rem;font-weight:600}
    .ll-feat:nth-child(1){border-color:rgba(255,50,100,0.2);color:var(--pink)}
    .ll-feat:nth-child(2){border-color:rgba(0,229,255,0.15);color:var(--cyan)}
    .ll-feat:nth-child(3){border-color:rgba(255,184,0,0.15);color:var(--gold)}
    .ll-feat:nth-child(4){border-color:rgba(0,220,130,0.15);color:var(--green)}
    .ll-stats{display:flex;gap:2.5rem}
    .ll-stat-num{font-family:var(--font-display);font-size:2rem;font-weight:800;color:var(--gold)}
    .ll-stat-lbl{font-size:0.65rem;color:var(--text3);text-transform:uppercase;letter-spacing:0.1em;margin-top:0.1rem}
    .auth-card{width:100%;max-width:400px;background:var(--card);border:1px solid var(--border);border-radius:var(--r);padding:2.5rem;backdrop-filter:blur(8px)}
    .auth-card-title{font-family:var(--font-display);font-size:1.2rem;font-weight:800;margin-bottom:0.35rem}
    .auth-card-sub{font-size:0.85rem;color:var(--text3);margin-bottom:1.5rem}
    .auth-toggle{display:flex;background:var(--elevated);border-radius:var(--r-pill);padding:3px;margin-bottom:1.25rem}
    .auth-t{flex:1;padding:0.65rem;border-radius:var(--r-pill);border:none;background:none;color:var(--text3);font-family:var(--font-display);font-weight:700;font-size:0.8rem;cursor:pointer;transition:all 0.2s}
    .auth-t.on{background:var(--card);color:var(--text)}
    .auth-form{display:flex;flex-direction:column;gap:0.7rem}
    .auth-form.hide{display:none}
    .auth-err{background:var(--red-s);border:1px solid rgba(255,71,87,0.2);color:var(--red);padding:0.6rem 0.75rem;border-radius:var(--r-sm);font-size:0.8rem;display:none}
    .auth-footer{text-align:center;margin-top:1.5rem;font-size:0.75rem;color:var(--text3)}
    .auth-footer a{color:var(--pink)}
  </style>
</head>
<body>
  <div class="page">
    <div class="orb3"></div>
    <div class="landing">
      <div class="landing-left">
        <div class="pill pill-pink ll-badge anim"><span class="live-dot"></span> Now Playing</div>
        <h1 class="display-xl ll-title anim anim-d1"><span class="fire-text">Mansion</span><br>Mayhem</h1>
        <p class="ll-desc anim anim-d2">Secret roles. Live betrayals. Vote your enemies out. Form alliances in secret. Confront rivals face to face. Crown yourself queen of the Mansion.</p>
        <div class="ll-feats anim anim-d3">
          <div class="ll-feat">üé≠ Secret Roles</div>
          <div class="ll-feat">üí• Confrontations</div>
          <div class="ll-feat">üó≥Ô∏è Live Voting</div>
          <div class="ll-feat">ü§ñ AI Agents</div>
        </div>
        <div class="ll-stats anim anim-d4">
          <div><div class="ll-stat-num">8</div><div class="ll-stat-lbl">Secret Roles</div></div>
          <div><div class="ll-stat-num">7</div><div class="ll-stat-lbl">Game Phases</div></div>
          <div><div class="ll-stat-num">35</div><div class="ll-stat-lbl">Min Per Game</div></div>
        </div>
      </div>
      <div class="landing-right">
        <div class="auth-card anim anim-d2">
          <div class="auth-card-title">Enter the Mansion</div>
          <div class="auth-card-sub">Sign in or create an account to play</div>
          <div class="auth-toggle">
            <button class="auth-t on" onclick="authTab('in')">Sign In</button>
            <button class="auth-t" onclick="authTab('up')">Sign Up</button>
          </div>
          <div id="authErr" class="auth-err"></div>
          <form id="formIn" class="auth-form" onsubmit="doSignIn(event)">
            <input class="input input-lg" type="email" name="email" placeholder="Email" required autocomplete="email">
            <input class="input input-lg" type="password" name="password" placeholder="Password" required autocomplete="current-password">
            <button class="btn btn-fire btn-block btn-lg" type="submit">Enter the Mansion</button>
          </form>
          <form id="formUp" class="auth-form hide" onsubmit="doSignUp(event)">
            <input class="input input-lg" type="text" name="name" placeholder="Display Name" required>
            <input class="input input-lg" type="email" name="email" placeholder="Email" required autocomplete="email">
            <input class="input input-lg" type="password" name="password" placeholder="Password (6+)" required minlength="6" autocomplete="new-password">
            <button class="btn btn-fire btn-block btn-lg" type="submit">Create Account</button>
          </form>
          <div class="auth-footer"><a href="/pages/how-to-play.html">How to Play</a> ¬∑ Trust is a luxury you can't afford.</div>
        </div>
      </div>
    </div>
  </div>
  <script type="module">
    import{waitForSupabase,getUser,signInWithEmail,signUpWithEmail}from'/js/supabase.js';
    waitForSupabase().then(async()=>{const u=await getUser();if(u)location.href='/pages/lobby.html'});
    window.authTab=(t)=>{document.querySelectorAll('.auth-t').forEach((b,i)=>b.classList.toggle('on',(i===0&&t==='in')||(i===1&&t==='up')));document.getElementById('formIn').classList.toggle('hide',t!=='in');document.getElementById('formUp').classList.toggle('hide',t!=='up');document.getElementById('authErr').style.display='none'};
    function err(m){const e=document.getElementById('authErr');e.textContent=m;e.style.display='block'}
    window.doSignIn=async(ev)=>{ev.preventDefault();const f=ev.target,b=f.querySelector('button');b.disabled=true;b.textContent='Entering...';const{error}=await signInWithEmail(f.email.value,f.password.value);if(error){err(error.message);b.disabled=false;b.textContent='Enter the Mansion'}else location.href='/pages/lobby.html'};
    window.doSignUp=async(ev)=>{ev.preventDefault();const f=ev.target,b=f.querySelector('button');b.disabled=true;b.textContent='Creating...';const{error}=await signUpWithEmail(f.email.value,f.password.value,f.name.value);if(error){err(error.message);b.disabled=false;b.textContent='Create Account'}else location.href='/pages/lobby.html'};
  </script>
</body>
</html>
